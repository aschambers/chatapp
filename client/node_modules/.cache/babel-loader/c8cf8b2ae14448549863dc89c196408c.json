{"ast":null,"code":"var drain = exports.drain = function (read, op, done) {\n  ;\n\n  (function next() {\n    var loop = true,\n        cbed = false;\n\n    while (loop) {\n      cbed = false;\n      read(null, function (end, data) {\n        cbed = true;\n\n        if (end) {\n          loop = false;\n          if (done) done(end === true ? null : end);else if (end && end !== true) throw end;\n        } else if (op && false === op(data)) {\n          loop = false;\n          read(true, done || function () {});\n        } else if (!loop) {\n          next();\n        }\n      });\n\n      if (!cbed) {\n        loop = false;\n        return;\n      }\n    }\n  })();\n};\n\nvar onEnd = exports.onEnd = function (read, done) {\n  return drain(read, null, done);\n};\n\nvar log = exports.log = function (read, done) {\n  return drain(read, function (data) {\n    console.log(data);\n  }, done);\n};","map":null,"metadata":{},"sourceType":"script"}