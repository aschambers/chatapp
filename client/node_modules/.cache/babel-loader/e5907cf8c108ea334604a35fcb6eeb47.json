{"ast":null,"code":"var u = require('pull-core');\n\nvar prop = u.prop;\nvar id = u.id;\nvar maybeSink = u.maybeSink;\n\nmodule.exports = function (pull) {\n  var exports = {};\n  var drain = pull.drain;\n\n  var find = exports.find = function (test, cb) {\n    return maybeSink(function (cb) {\n      var ended = false;\n      if (!cb) cb = test, test = id;else test = prop(test) || id;\n      return drain(function (data) {\n        if (test(data)) {\n          ended = true;\n          cb(null, data);\n          return false;\n        }\n      }, function (err) {\n        if (ended) return; //already called back\n\n        cb(err === true ? null : err, null);\n      });\n    }, cb);\n  };\n\n  var reduce = exports.reduce = function (reduce, acc, cb) {\n    return maybeSink(function (cb) {\n      return drain(function (data) {\n        acc = reduce(acc, data);\n      }, function (err) {\n        cb(err, acc);\n      });\n    }, cb);\n  };\n\n  var collect = exports.collect = exports.writeArray = function (cb) {\n    return reduce(function (arr, item) {\n      arr.push(item);\n      return arr;\n    }, [], cb);\n  };\n\n  return exports;\n};","map":null,"metadata":{},"sourceType":"script"}